{% extends 'base.html' %}
{% load static %}

{% block title %}–í—ã–±–æ—Ä –æ—Ç—á—ë—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞{% endblock %}

{% block content %}
<h2 class="mt-3 mb-4">üìä –í—ã–±–æ—Ä –æ—Ç—á—ë—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞</h2>

<form method="post" class="row g-2 mb-4">
    {% csrf_token %}
    <div class="col-auto">
        <label for="month" class="form-label">–ú–µ—Å—è—Ü:</label>
        <select name="month" id="month" class="form-select">
            {% for month in months %}
                <option value="{{ month }}" {% if month == selected_month %}selected{% endif %}>{{ month }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-auto">
        <label for="year" class="form-label">–ì–æ–¥:</label>
        <select name="year" id="year" class="form-select">
            {% for year in years %}
                <option value="{{ year }}" {% if year == selected_year %}selected{% endif %}>{{ year }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-auto align-self-end">
        <button type="submit" class="btn btn-primary">üìÑ –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç</button>
    </div>
    {% if report_data %}
    <div class="col-auto align-self-end">
        <a href="{% url 'export_report_excel' %}?month={{ selected_month }}&year={{ selected_year }}" class="btn btn-success">üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</a>
    </div>
    {% endif %}
</form>

{% if report_data %}
<h4>üìÅ –û—Ç—á—ë—Ç –∑–∞ {{ selected_month }} {{ selected_year }}</h4>
<div class="table-responsive">
<table id="report-table" class="table table-bordered table-striped table-sm datatable">
    <thead class="table-light">
        <tr>
            <th>ID</th><th>Service ID</th><th>Revenue Type</th><th>Contractor</th>
            <th>Contract Number</th><th>Sign Date</th><th>Subject</th><th>Code</th>
            <th>Type</th><th>Status</th><th>Amount</th><th>Cost (—Å –ù–î–°)</th>
        </tr>
       
    </thead>
    <tbody>
        {% for row in report_data %}
        <tr>
            <td>{{ row.id }}</td>
            <td>{{ row.service_id }}</td>
            <td>{{ row.revenue_type }}</td>
            <td>{{ row.contractor }}</td>
            <td>{{ row.contract_number }}</td>
            <td>{{ row.sign_date }}</td>
            <td>{{ row.subject }}</td>
            <td>{{ row.code }}</td>
            <td>{{ row.type }}</td>
            <td>{{ row.status }}</td>
            <td>{{ row.ammount }}</td>
            <td>{{ row.cost_vat }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% endif %}
{% endblock %}


